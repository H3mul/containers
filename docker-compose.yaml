services:
  code-space-test:
    build:
      context: ./apps/code-space/.
    ports:
      - 8022:22
      - 8080:8080

  hass-test:
    build:
      context: ./apps/home-assistant/.
      args:
        VERSION: 2024.7.2
    # environment:
    #   LD_LIBRARY_PATH: /usr/lib

  vintagestory:
    build:
      context: ./apps/vintagestory/.
      args:
        VERSION: 1.20.11
    ports:
      - 42420:42420
    volumes:
      - "${PWD}/apps/vintagestory/mods.yaml:/init/mods.yaml:ro"

  comfyui:
    build:
      context: ./apps/comfyui/.
      args:
        VERSION: v0.3.62

  fluxgym:
    build:
      context: ./apps/fluxgym/.
      args:
        VERSION: 93c801d
    ports:
      - 7860:7860
      - 8080:8080

  renovate:
    image: renovate/renovate
    command:
      - "renovate"
      - "--platform=local"

    environment:
      LOG_LEVEL: debug
    working_dir: /renovate
    volumes:
      - ${PWD}:/renovate

  mysql-init:
    build:
      context: ./apps/mysql-init/.
      args:
        VERSION: 11.4.8-r0

  timelapser:
    build:
      context: ./apps/timelapser/.
    environment:
      PERIOD_DAYS: 7
      INPUT_DIR: /input
      OUTPUT_DIR: /output

  notion-exporter:
    build:
      context: ./apps/notion-exporter/.
    environment:
      NOTION_TOKEN: ${NOTION_TOKEN}
      NOTION_FILE_TOKEN: ${NOTION_FILE_TOKEN}
      NOTION_BLOCK_ID: ${NOTION_BLOCK_ID}
      OUTPUT_DIR: "/data"
    volumes:
      - ./apps/notion-exporter/test-data:/data