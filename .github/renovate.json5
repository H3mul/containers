{
    extends: [
        'config:best-practices',
        ':automergeMinor',
        ':automergePr',
        ':disableRateLimiting',
        ':docker',
    ],
    printConfig: false,
    dependencyDashboardAutoclose: true,
    automerge: true,
    platformAutomerge: true,
    baseBranches: [
        'master',
    ],
    ignoreTests: true,
    includePaths: [
        '.github/renovate.json5',
        '.github/workflows/**',
        'apps/**',
    ],
    customManagers: [
        {
            customType: 'regex',
            description: 'Update pinned metadata versions',
            managerFilePatterns: [
                '/(^|/)metadata\\.yaml$/',
            ],
            matchStrings: [
                'renovate: datasource=(?<datasource>.*?) depName=(?<depName>.*?)( versioning=(?<versioning>.*?))?\\sversion: (?<currentValue>.*)\\s',
            ],
        },
        {
            customType: 'regex',
            description: 'Update pinned dockerfile arg/env versions',
            managerFilePatterns: [
                '/(^|/)Dockerfile$/',
                '/(^|/)Dockerfile\\.[^/]*$/',
            ],
            matchStrings: [
                'renovate: datasource=(?<datasource>.*?) depName=(?<depName>.*?)( versioning=(?<versioning>.*?))?\\s(ARG|ENV) .*?_VERSION=(?<currentValue>.*)\\s',
            ],
        },
        {
            customType: 'regex',
            description: 'Process Vintage Story mods',
            managerFilePatterns: [
                '/(^|/)vintagestory(-\\w+)?/.*/mods\\.yaml$/',
            ],
            matchStrings: [
                '- id: (?<packageName>\\S+)\\n(?<indentation>\\s+)version: (?<currentValue>\\S+)',
            ],
            autoReplaceStringTemplate: '- id: {{{packageName}}}\n{{{indentation}}}version: {{{newValue}}}',
            datasourceTemplate: 'custom.vs-mods',
            versioningTemplate: 'semver-coerced',
        },
    ],
    customDatasources: {
        'vs-mods': {
            defaultRegistryUrlTemplate: 'https://mods.vintagestory.at/api/mod/{{packageName}}',
            format: 'json',
            transformTemplates: [
                '{"releases":[{"version": mod.releases[0].modversion, "releaseTimestamp": mod.releases[0].created}], "sourceUrl": "https://mods.vintagestory.at/" & mod.urlalias & "#tab-files"}',
            ],
        },
        'vs-game': {
            defaultRegistryUrlTemplate: 'https://mods.vintagestory.at/api/gameversions',
            format: 'json',
            transformTemplates: [
                '{"releases":[ gameversions.{"version": name} ]}',
            ],
        },
    },
    packageRules: [
        {
            matchDatasources: [
                'custom.vs-mods',
            ],
            matchManagers: [
                'custom.regex',
            ],
            semanticCommitScope: 'vintage-story',
            commitMessageTopic: 'mod {{depName}}',
            commitMessageExtra: '( {{currentVersion}} → {{newVersion}} )',
        },
        {
            matchDatasources: [
                'custom.vs-game',
            ],
            matchManagers: [
                'custom.regex',
            ],
            semanticCommitScope: 'vintage-story',
            commitMessageTopic: 'game version {{depName}}',
            commitMessageExtra: '( {{currentVersion}} → {{newVersion}} )',
        },
    ],
}
